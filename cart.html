<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart | Aadya</title>
    
    <!-- Google Fonts: Poppins & Lato -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
      <!-- Cart Functionality Script -->
    <script src="aadya-cart.js"></script>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, doc, updateDoc, getDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyBzi_HweeamgBRWOzH4Mq7bjLv_g8elZx0",
            authDomain: "aadya-fashions.firebaseapp.com",
            projectId: "aadya-fashions",
            storageBucket: "aadya-fashions.firebasestorage.app",
            messagingSenderId: "721311924078",
            appId: "1:721311924078:web:3e16ea2ba0a07fd6678b7f"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        window.firebaseServices = { db, doc, updateDoc, getDoc };
    </script>    <style>
        :root {
            /* Updated Color Scheme */
            --primary-background: #FFFFFF;
            --page-background: #F8F9FA;
            --modern-orange: #FF9800;
            --modern-blue: #42A5F5;
            --dark-gray: #333333;
            --medium-gray: #666666;
            --light-gray: #E0E0E0;
            --navy-blue: #1976D2;
            --bright-red: #F44336;
            --vibrant-green: #4CAF50;
            --summary-background: #F5F5F5;
            --focus-blue: #2196F3;
            --hover-gray: #F0F0F0;
            
            /* Legacy variables for compatibility */
            --primary-peach: #FFDAB9;
            --primary-pink: #F8C8DC;
            --accent-coral: var(--modern-orange);
            --text-charcoal: var(--dark-gray);
            --neutral-white: var(--primary-background);
            --soft-gray: var(--page-background);
            --font-heading: 'Poppins', sans-serif;
            --font-body: 'Lato', sans-serif;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            
            /* Dark Theme Colors */
            --dark-bg: #0F0D0E;
            --dark-surface: #1A1617;
            --dark-accent: #100C0D;
            --primary-pink-dark: #CC8B65;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.5;
            color: var(--text-charcoal);
            background-color: var(--page-background);
            transition: background-color 0.3s ease, color 0.3s ease;
            font-size: 14px;
        }

        /* Top Bar */
        .top-bar {
            background: linear-gradient(135deg, var(--modern-orange), #FF8A00);
            color: var(--neutral-white);
            text-align: center;
            padding: 12px 0;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }        /* Header */        
        .header {
            background-color: var(--primary-background);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            transition: background-color 0.3s ease;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            max-width: 1200px;
            margin: 0 auto;
            padding-left: 20px;
            padding-right: 20px;
        }        

        .logo {
            font-family: var(--font-heading);
            font-size: 2rem;
            font-weight: 700;
            color: var(--modern-orange);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 30px;
        }        

        .nav-links a {
            text-decoration: none;
            color: var(--dark-gray);
            font-weight: 500;
            transition: var(--transition);
        }

        .nav-links a:hover {
            color: var(--modern-orange);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .icon {
            position: relative;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
        }        

        .icon:hover {
            background-color: var(--hover-gray);
        }        

        .icon i {
            font-size: 1.2rem;
            color: var(--dark-gray);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--bright-red);
            color: var(--neutral-white);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }        /* Enhanced Buttons */
        .btn {
            display: inline-block;
            padding: 14px 28px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            border: 2px solid transparent;
            transition: var(--transition);
            cursor: pointer;
            font-family: var(--font-body);
            font-size: 16px;
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn:focus {
            outline: 2px solid var(--focus-blue);
            outline-offset: 2px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--bright-red), #D32F2F);
            color: var(--neutral-white);
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(244, 67, 54, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #D32F2F, #B71C1C);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(244, 67, 54, 0.4);
        }

        .btn-secondary {
            background-color: var(--primary-background);
            color: var(--navy-blue);
            border-color: var(--navy-blue);
            font-weight: 600;
        }

        .btn-secondary:hover {
            background-color: var(--navy-blue);
            color: var(--neutral-white);
            transform: translateY(-1px);
        }

        .btn-danger {
            background-color: var(--bright-red);
            color: var(--neutral-white);
        }

        .btn-danger:hover {
            background-color: #D32F2F;
            transform: translateY(-1px);
        }        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .cart-page {
            min-height: 60vh;
        }        

        .page-title {
            font-family: var(--font-heading);
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 40px;
            color: var(--dark-gray);
        }

        .cart-content {
            display: grid;
            grid-template-columns: 65% 30%;
            gap: 5%;
            align-items: start;
        }

        .cart-items-section {
            background-color: var(--primary-background);
            border-radius: 12px;
            padding: 32px;
            box-shadow: var(--shadow);
            border: 1px solid var(--light-gray);
        }

        .cart-items-section h2 {
            font-family: var(--font-heading);
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--dark-gray);
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 24px;
            border: 1px solid var(--light-gray);
            border-radius: 12px;
            margin-bottom: 24px;
            background-color: var(--primary-background);
            transition: var(--transition);
            position: relative;
        }

        .cart-item:hover {
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .cart-item:not(:last-child)::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 20px;
            right: 20px;
            height: 1px;
            background-color: var(--light-gray);
        }

        .item-image {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 20px;
            border: 1px solid var(--light-gray);
        }

        .item-details {
            flex: 1;
        }        

        .item-name {
            font-family: var(--font-heading);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--navy-blue);
            cursor: pointer;
            transition: var(--transition);
        }

        .item-name:hover {
            color: var(--modern-blue);
            text-decoration: underline;
        }        

        .item-attributes {
            font-size: 14px;
            color: var(--medium-gray);
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .item-price {
            font-size: 16px;
            font-weight: bold;
            color: #000000;
        }        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 0 20px;
        }        

        .quantity-btn {
            width: 40px;
            height: 40px;
            border: 1px solid var(--light-gray);
            background-color: var(--light-gray);
            color: var(--dark-gray);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 600;
            transition: var(--transition);
            min-height: 44px;
        }

        .quantity-btn:hover {
            background-color: var(--medium-gray);
            color: var(--primary-background);
            transform: translateY(-1px);
        }

        .quantity-btn:focus {
            outline: 2px solid var(--focus-blue);
            outline-offset: 2px;
        }

        .quantity-input {
            width: 70px;
            height: 40px;
            text-align: center;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            color: var(--dark-gray);
            background-color: var(--primary-background);
        }

        .quantity-input:focus {
            outline: none;
            border-color: var(--focus-blue);
        }

        .remove-btn {
            background: none;
            border: none;
            color: var(--bright-red);
            cursor: pointer;
            font-size: 1.4rem;
            padding: 12px;
            border-radius: 8px;
            transition: var(--transition);
            min-height: 44px;
            width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .remove-btn:hover {
            background-color: var(--bright-red);
            color: var(--neutral-white);
            transform: scale(1.1);
        }

        .remove-btn:focus {
            outline: 2px solid var(--focus-blue);
            outline-offset: 2px;
        }        /* Enhanced Cart Summary */
        .cart-summary {
            background-color: var(--summary-background);
            border-radius: 12px;
            padding: 32px;
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 140px;
            border: 1px solid var(--light-gray);
        }        

        .summary-title {
            font-family: var(--font-heading);
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 24px;
            color: var(--dark-gray);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            font-size: 16px;
            color: var(--medium-gray);
        }

        .summary-row.total {
            font-weight: bold;
            font-size: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--bright-red);
            color: var(--bright-red);
            margin-top: 20px;
        }        

        .shipping-info {
            background: linear-gradient(135deg, var(--vibrant-green), #388E3C);
            color: var(--primary-background);
            padding: 16px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }

        .shipping-info i {
            margin-right: 8px;
            font-size: 16px;
        }

        .checkout-buttons {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 32px;
        }

        /* Progress Indicator */
        .progress-indicator {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding: 16px;
            background-color: var(--primary-background);
            border-radius: 8px;
            border: 1px solid var(--light-gray);
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            flex: 1;
            position: relative;
        }

        .progress-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            right: -50%;
            width: 100%;
            height: 2px;
            background-color: var(--light-gray);
            z-index: 1;
        }

        .progress-step.active::after {
            background-color: var(--modern-orange);
        }

        .progress-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--light-gray);
            color: var(--medium-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 600;
            z-index: 2;
            position: relative;
        }

        .progress-step.active .progress-icon {
            background-color: var(--modern-orange);
            color: var(--primary-background);
        }

        .progress-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--medium-gray);
            text-align: center;
        }

        .progress-step.active .progress-label {
            color: var(--modern-orange);
        }        /* Enhanced Empty Cart */
        .empty-cart {
            text-align: center;
            padding: 80px 40px;
            background-color: var(--primary-background);
            border-radius: 12px;
            box-shadow: var(--shadow);
            border: 1px solid var(--light-gray);
        }

        .empty-cart i {
            font-size: 5rem;
            color: var(--light-gray);
            margin-bottom: 24px;
        }

        .empty-cart h2 {
            font-family: var(--font-heading);
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--dark-gray);
        }

        .empty-cart p {
            font-size: 16px;
            color: var(--medium-gray);
            margin-bottom: 32px;
            line-height: 1.6;
        }

        /* Security Badges */
        .security-badges {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            padding: 16px;
            background-color: rgba(76, 175, 80, 0.1);
            border-radius: 8px;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--vibrant-green);
            font-weight: 600;
        }

        .security-badge i {
            font-size: 14px;
        }

        /* Recommended Products */        .recommended-section {
            margin-top: 60px;
            padding-top: 40px;
            border-top: 1px solid #eee;
        }        .section-title {
            font-family: var(--font-heading);
            font-size: 2rem;
            text-align: center;
            margin-bottom: 30px;
            color: var(--text-charcoal);
        }

        /* User Info Section Styles */
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 8px 12px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-right: 15px;
        }

        .user-phone {
            color: var(--neutral-white);
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-phone::before {
            content: '\f007';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--accent-coral);
        }

        .logout-btn {
            background: linear-gradient(135deg, #ff4757, #ff3838);
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .logout-btn:hover {
            background: linear-gradient(135deg, #ff3838, #ff2f2f);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 71, 87, 0.4);
        }

        .logout-btn i {
            font-size: 11px;
        }

        [data-theme="dark"] .user-info {
            background-color: rgba(204, 139, 101, 0.1);
            border-color: rgba(204, 139, 101, 0.3);
        }

        [data-theme="dark"] .user-phone {
            color: var(--primary-peach);
        }

        /* Responsive adjustments for user info */
        @media (max-width: 768px) {
            .user-info {
                gap: 10px;
                padding: 6px 10px;
                margin-right: 10px;
            }
            
            .user-phone {
                font-size: 12px;
            }
            
            .logout-btn {
                padding: 5px 8px;
                font-size: 11px;
            }
        }

        @media (max-width: 480px) {
            .user-info {
                gap: 8px;
                padding: 5px 8px;
            }
            
            .user-phone {
                font-size: 11px;
            }
            
            .logout-btn {
                padding: 4px 6px;
                font-size: 10px;
            }
        }        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }

            .cart-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .cart-summary {
                position: static;
                order: 2;
            }

            .cart-items-section {
                order: 1;
                padding: 24px 20px;
            }

            .cart-item {
                flex-direction: column;
                text-align: center;
                padding: 20px;
            }

            .item-image {
                margin-right: 0;
                margin-bottom: 16px;
                width: 100px;
                height: 100px;
            }

            .quantity-controls {
                margin: 16px 0;
                justify-content: center;
            }

            .nav-links {
                display: none;
            }

            .page-title {
                font-size: 28px;
            }

            .btn {
                min-height: 48px;
                font-size: 16px;
            }

            .progress-indicator {
                flex-wrap: wrap;
                gap: 16px;
            }

            .progress-step {
                flex: none;
                width: calc(50% - 8px);
            }

            .progress-step:not(:last-child)::after {
                display: none;
            }
        }

        @media (max-width: 576px) {
            .cart-items-section,
            .cart-summary {
                padding: 20px 16px;
            }

            .item-image {
                width: 80px;
                height: 80px;
            }

            .checkout-buttons {
                gap: 12px;
            }

            .checkout-buttons .btn {
                padding: 12px 20px;
                font-size: 15px;
            }

            .cart-item {
                padding: 16px;
            }

            .quantity-btn {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }

            .quantity-input {
                width: 60px;
                height: 36px;
            }

            .page-title {
                font-size: 24px;
                margin-bottom: 24px;
            }

            .progress-step {
                width: 100%;
            }

            .progress-icon {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
        }

        /* Animation keyframes */
        @keyframes slideInNotification {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutNotification {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        /* Focus styles for better accessibility */
        *:focus {
            outline: 2px solid var(--focus-blue);
            outline-offset: 2px;
        }

        input:focus, button:focus {
            outline: 2px solid var(--focus-blue);
            outline-offset: 2px;
        }

        /* Loading state for buttons */
        .btn-loading {
            position: relative;
            color: transparent !important;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <!-- TOP ANNOUNCEMENT BAR -->
    <div class="top-bar">
        Buy 5 Kurtis & Get Free Delivery + 10% Discount!
    </div>

    <!-- HEADER -->
    <header class="header">
        <div class="navbar">
            <a href="index.html" class="logo">Aadya</a>
            
            <ul class="nav-links">                <li><a href="index.html#home">Home</a></li>
                <li><a href="index.html#shop">Shop</a></li>
                <li><a href="index.html#offers">Offers</a></li>
                <li><a href="index.html#about">About Us</a></li>
                <li><a href="index.html#contact">Contact</a></li>
            </ul><div class="header-actions">
                
                <!-- User Info & Logout -->
                <div class="user-info" id="userInfo" style="display: none;">
                    <div class="user-phone" id="userPhone">+91 XXXXX XXXXX</div>
                    <button class="logout-btn" id="logoutBtn" onclick="logout()">
                        <i class="fa-solid fa-sign-out-alt"></i> Logout
                    </button>
                </div>
                
                <div class="icon" id="cart-icon">
                    <i class="fa-solid fa-cart-shopping"></i>                <span class="cart-count" id="cartCount">0</span>
                </div>
                
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="cart-page">
        <div class="container">
            <h1 class="page-title">Shopping Cart</h1>
            
            <div id="cart-content">
                <!-- Cart content will be populated by JavaScript -->
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="header" style="margin-top: 60px;">
        <div class="navbar" style="justify-content: center;">
            <p>&copy; 2025 Aadya Fashions. All Rights Reserved.</p>
        </div>
    </footer>    <script>        
        // Cart utility functions
        function getCart() {
            return JSON.parse(localStorage.getItem('aadya_cart') || '[]');
        }

        function saveCart(cart) {
            localStorage.setItem('aadya_cart', JSON.stringify(cart));
            updateCartCount();
        }

        function updateCartCount() {
            const cartCountElement = document.getElementById('cartCount');
            if (cartCountElement) {
                const cart = getCart();
                const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
                cartCountElement.textContent = totalItems;
            }
        }

        function setupCartIcon() {
            const cartIcon = document.querySelector('.icon[onclick="window.location.href=\'cart.html\'"]');
            if (cartIcon) {
                cartIcon.onclick = function() {
                    window.location.href = 'cart.html';
                };
            }
        }

        // Initialize cart page
        document.addEventListener('DOMContentLoaded', function() {
            // Load cart content
            loadCartContent();
            
            // Update cart count
            updateCartCount();
            
            // Setup cart icon click (redirect to current page or refresh)
            setupCartIcon();
        });

        // Debug function to check cart loading
        function debugCart() {
            console.log('=== CART DEBUG ===');
            const cart = getCart();
            console.log('Cart from localStorage:', cart);
            console.log('Cart length:', cart.length);
            
            const cartContent = document.getElementById('cart-content');
            console.log('Cart content element:', cartContent);
            
            if (cart.length === 0) {
                console.log('Cart is empty, showing empty cart message');
            } else {
                console.log('Cart has items, rendering cart items');
            }
            console.log('=== END DEBUG ===');
        }

        function loadCartContent() {
            debugCart(); // Add debug call
            
            const cart = getCart();
            const cartContent = document.getElementById('cart-content');
            
            if (cart.length === 0) {
                showEmptyCart(cartContent);
            } else {
                showCartWithItems(cartContent, cart);
            }
        }        function showEmptyCart(container) {
            container.innerHTML = `
                <div class="empty-cart">
                    <i class="fa-solid fa-cart-shopping"></i>
                    <h2>Your cart is empty</h2>
                    <p>Looks like you haven't added any items to your cart yet.<br>Start shopping to fill it up!</p>
                    <a href="index.html#shop" class="btn btn-primary">
                        <i class="fa-solid fa-shopping-bag"></i>
                        Start Shopping
                    </a>
                </div>
            `;
        }        function showCartWithItems(container, cart) {
            let subtotal = 0;
            
            const cartItemsHtml = cart.map(item => {
                const itemTotal = parseFloat(item.price) * item.quantity;
                subtotal += itemTotal;
                
                return `
                    <div class="cart-item" data-item-id="${item.id}">
                        <img src="${item.image || 'https://placehold.co/400x500/cccccc/333333?text=Image'}" alt="${item.name}" class="item-image">
                        
                        <div class="item-details">
                            <div class="item-name" onclick="goToProduct('${item.id}')">${item.name}</div>
                            <div class="item-attributes">
                                ${item.color ? `<span><i class="fa-solid fa-palette"></i> Color: ${item.color}</span>` : ''} 
                                ${item.size ? `<span><i class="fa-solid fa-ruler"></i> Size: ${item.size}</span>` : ''} 
                            </div>
                            <div class="item-price">₹${item.price} each</div>
                        </div>
                        
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity('${item.id}', ${item.quantity - 1})" aria-label="Decrease quantity">
                                <i class="fa-solid fa-minus"></i>
                            </button>
                            <input type="number" class="quantity-input" value="${item.quantity}" min="1" onchange="updateQuantity('${item.id}', this.value)" aria-label="Quantity">
                            <button class="quantity-btn" onclick="updateQuantity('${item.id}', ${item.quantity + 1})" aria-label="Increase quantity">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                        
                        <div style="text-align: right; margin-left: 20px;">
                            <div style="font-weight: bold; font-size: 16px; color: #000000; margin-bottom: 12px;">₹${itemTotal.toFixed(2)}</div>
                            <button class="remove-btn" onclick="removeFromCart('${item.id}')" aria-label="Remove item">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            const shipping = subtotal >= 999 ? 0 : 99;
            const total = subtotal + shipping;
            const freeShippingAmount = 999 - subtotal;

            container.innerHTML = `
                <!-- Progress Indicator -->
                <div class="progress-indicator">
                    <div class="progress-step active">
                        <div class="progress-icon">1</div>
                        <div class="progress-label">Cart</div>
                    </div>
                    <div class="progress-step">
                        <div class="progress-icon">2</div>
                        <div class="progress-label">Checkout</div>
                    </div>
                    <div class="progress-step">
                        <div class="progress-icon">3</div>
                        <div class="progress-label">Payment</div>
                    </div>
                    <div class="progress-step">
                        <div class="progress-icon">4</div>
                        <div class="progress-label">Confirmation</div>
                    </div>
                </div>

                <div class="cart-content">
                    <div class="cart-items-section">
                        <h2><i class="fa-solid fa-shopping-cart"></i> Cart Items (${cart.length})</h2>
                        ${cartItemsHtml}
                    </div>
                    
                    <div class="cart-summary">
                        <h3 class="summary-title"><i class="fa-solid fa-receipt"></i> Order Summary</h3>
                        
                        <div class="summary-row">
                            <span>Subtotal (${cart.length} item${cart.length > 1 ? 's' : ''})</span>
                            <span><strong>₹${subtotal.toFixed(2)}</strong></span>
                        </div>
                        
                        <div class="summary-row">
                            <span>Shipping</span>
                            <span style="color: ${shipping === 0 ? 'var(--vibrant-green)' : 'var(--medium-gray)'}">
                                ${shipping === 0 ? 'FREE' : '₹' + shipping.toFixed(2)}
                            </span>
                        </div>
                        
                        <div class="summary-row total">
                            <span>Total Amount</span>
                            <span>₹${total.toFixed(2)}</span>
                        </div>
                        
                        ${shipping === 0 ? 
                            '<div class="shipping-info"><i class="fa-solid fa-truck"></i> Congratulations! You get FREE shipping!</div>' : 
                            `<div class="shipping-info" style="background: linear-gradient(135deg, var(--modern-blue), #1976D2); color: var(--primary-background);"><i class="fa-solid fa-info-circle"></i> Add ₹${freeShippingAmount.toFixed(2)} more for FREE shipping!</div>`
                        }
                        
                        <div class="security-badges">
                            <div class="security-badge">
                                <i class="fa-solid fa-shield-check"></i>
                                <span>Secure Checkout</span>
                            </div>
                            <div class="security-badge">
                                <i class="fa-solid fa-truck-fast"></i>
                                <span>Fast Delivery</span>
                            </div>
                            <div class="security-badge">
                                <i class="fa-solid fa-undo"></i>
                                <span>Easy Returns</span>
                            </div>
                        </div>
                        
                        <div class="checkout-buttons">
                            <button class="btn btn-primary" onclick="proceedToCheckout()">
                                <i class="fa-solid fa-credit-card"></i>
                                Proceed to Checkout
                            </button>
                            <button class="btn" style="background: linear-gradient(135deg, var(--vibrant-green), #388E3C); color: white; margin-top: 12px;" onclick="simulatePurchaseDemo()">
                                <i class="fa-solid fa-shopping-bag"></i>
                                Demo Purchase (Updates Stock)
                            </button>
                            <a href="index.html#shop" class="btn btn-secondary">
                                <i class="fa-solid fa-arrow-left"></i>
                                Continue Shopping
                            </a>                        </div>
                    </div>
                </div>
            `;
        }

        // Helper function for product navigation
        function goToProduct(productId) {
            // In a real application, this would navigate to the product detail page
            console.log('Navigate to product:', productId);
            // You can implement this to redirect to product detail page
            // window.location.href = `product-detail.html?id=${productId}`;
        }

        function updateQuantity(itemId, newQuantity) {
            newQuantity = parseInt(newQuantity);
            
            if (newQuantity < 1) {
                removeFromCart(itemId);
                return;
            }
            
            const cart = getCart();
            const itemIndex = cart.findIndex(item => item.id === itemId);
            
            if (itemIndex > -1) {
                cart[itemIndex].quantity = newQuantity;
                saveCart(cart);
                loadCartContent(); // Refresh the cart display
                showNotification('Cart updated successfully!');
            }
        }        function proceedToCheckout() {
            const cart = getCart();
            
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            // Redirect to payment page
            window.location.href = 'payment.html';
        }

        // Demo purchase functionality that updates stock in Firebase
        async function simulatePurchaseDemo() {
            const cart = getCart();
            
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }

            // Show loading notification
            showNotification('Processing purchase...', 'info');

            try {
                const { db, doc, updateDoc, getDoc } = window.firebaseServices;
                let allUpdatesSuccessful = true;
                let purchaseDetails = [];

                for (const item of cart) {
                    try {
                        // Get the product ID (handling different naming conventions)
                        const productId = item.productId || item.id.split('_')[0] || item.id;
                        
                        console.log(`Processing purchase for product ID: ${productId}, quantity: ${item.quantity}`);
                        
                        // Get current product data
                        const productRef = doc(db, 'products', productId);
                        const productDoc = await getDoc(productRef);
                        
                        if (!productDoc.exists()) {
                            console.error(`Product ${productId} not found`);
                            allUpdatesSuccessful = false;
                            continue;
                        }
                        
                        const productData = productDoc.data();
                        
                        // Check if sufficient stock available
                        if (productData.stock < item.quantity) {
                            alert(`Insufficient stock for ${item.name}. Available: ${productData.stock}, Requested: ${item.quantity}`);
                            allUpdatesSuccessful = false;
                            continue;
                        }
                        
                        // Calculate new stock
                        const newStock = Math.max(0, productData.stock - item.quantity);
                        
                        // Prepare update data
                        const updateData = {
                            stock: newStock,
                            lastStockUpdate: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };
                        
                        // Update analytics if available
                        if (productData.analytics) {
                            const purchaseRevenue = parseFloat(item.price) * item.quantity;
                            const profit = productData.costPrice ? 
                                (parseFloat(item.price) - productData.costPrice) * item.quantity : 0;
                            
                            updateData['analytics.purchases'] = (productData.analytics.purchases || 0) + 1;
                            updateData['analytics.revenue'] = (productData.analytics.revenue || 0) + purchaseRevenue;
                            updateData['analytics.profitGenerated'] = (productData.analytics.profitGenerated || 0) + profit;
                            updateData['analytics.cartAdds'] = (productData.analytics.cartAdds || 0) + 1;
                            
                            // Add to stock movements
                            const stockMovement = {
                                type: 'sale',
                                quantity: newStock,
                                previousQuantity: productData.stock,
                                soldQuantity: item.quantity,
                                timestamp: new Date().toISOString(),
                                note: `Sale - ${item.quantity} units sold`,
                                purchaseDetails: {
                                    price: item.price,
                                    color: item.color,
                                    size: item.size,
                                    revenue: purchaseRevenue,
                                    profit: profit
                                }
                            };
                            
                            updateData['analytics.stockMovements'] = [
                                ...(productData.analytics.stockMovements || []),
                                stockMovement
                            ];
                        }
                        
                        // Update stock alerts
                        updateData['alerts.lowStock'] = newStock <= (productData.minStockLevel || 5);
                        updateData['alerts.outOfStock'] = newStock === 0;
                        
                        // Update the document
                        await updateDoc(productRef, updateData);
                        
                        purchaseDetails.push({
                            productId: productId,
                            name: item.name,
                            quantity: item.quantity,
                            price: item.price,
                            newStock: newStock,
                            oldStock: productData.stock
                        });
                        
                        console.log(`Stock updated for ${item.name}: ${productData.stock} → ${newStock}`);
                        
                    } catch (error) {
                        console.error(`Error updating stock for ${item.name}:`, error);
                        allUpdatesSuccessful = false;
                    }
                }

                if (allUpdatesSuccessful && purchaseDetails.length > 0) {
                    // Show success message with details
                    let successMessage = 'Purchase successful! Stock updated:\n\n';
                    purchaseDetails.forEach(detail => {
                        successMessage += `${detail.name}: ${detail.oldStock} → ${detail.newStock} (${detail.quantity} sold)\n`;
                    });
                    
                    alert(successMessage);
                    
                    // Clear the cart
                    localStorage.removeItem('aadya_cart');
                    updateCartCount();
                    
                    // Reload cart content
                    loadCartContent();
                    
                    showNotification('Purchase completed! Inventory updated.', 'success');
                    
                    // Optional: Redirect to a thank you page
                    setTimeout(() => {
                        if (confirm('Purchase completed! Would you like to continue shopping?')) {
                            window.location.href = 'index.html#shop';
                        }
                    }, 2000);
                    
                } else {
                    showNotification('Some items could not be processed. Please try again.', 'error');
                }

            } catch (error) {
                console.error('Error processing purchase:', error);
                showNotification('Purchase failed. Please try again.', 'error');
            }
        }

        // Enhanced notification function
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.cart-notification');
            existingNotifications.forEach(notification => notification.remove());

            const notification = document.createElement('div');
            notification.className = 'cart-notification';
            
            const backgroundColor = {
                'success': '#28a745',
                'error': '#dc3545',
                'warning': '#ffc107',
                'info': '#17a2b8'
            }[type] || '#17a2b8';
            
            const textColor = type === 'warning' ? '#212529' : '#fff';
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: ${backgroundColor};
                color: ${textColor};
                padding: 15px 25px;
                border-radius: 8px;
                z-index: 10000;
                font-weight: 500;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                animation: slideInNotification 0.3s ease;
                max-width: 300px;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px;">
                    <i class="fa-solid ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after delay
            setTimeout(() => {
                notification.style.animation = 'slideOutNotification 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, type === 'info' ? 2000 : 4000);
        }

        // Override the cart icon setup for this page
        function setupCartIcon() {
            const cartIcon = document.getElementById('cart-icon');
            
            if (cartIcon) {
                cartIcon.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Since we're already on the cart page, just refresh the content
                    loadCartContent();
                });
            }
        }

        // Custom removeFromCart function that refreshes the page content
        function removeFromCartAndRefresh(itemId) {
            removeFromCart(itemId);
            loadCartContent();
            showNotification('Item removed from cart!');
        }

        // Override the global removeFromCart to use our refresh function
        window.removeFromCart = function(itemId) {
            const cart = getCart();
            const updatedCart = cart.filter(item => item.id !== itemId);
            saveCart(updatedCart);
            loadCartContent(); // Refresh the cart display
            showNotification('Item removed from cart!');
        };

        // Show notification function (reuse from cart.js if available)
        function showNotification(message) {
            let notification = document.getElementById('cart-notification');
            
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'cart-notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background-color: var(--accent-coral);
                    color: white;
                    padding: 15px 25px;
                    border-radius: 8px;
                    z-index: 1000;
                    opacity: 0;
                    transform: translateY(-20px);
                    transition: opacity 0.3s ease, transform 0.3s ease;
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
                    font-weight: bold;
                `;
                document.body.appendChild(notification);
            }
            
            notification.textContent = message;
            notification.style.opacity = '1';
            notification.style.transform = 'translateY(0)';
              setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
            }, 3000);        }

        // Secret admin access via keyboard shortcut (Ctrl+Shift+A)
        document.addEventListener('keydown', function(e) {
            // Check for Ctrl+Shift+A combination
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                e.preventDefault();
                
                const password = prompt('🔐 Admin Access\nEnter password:');
                
                if (password === 'AadyaAdmin2025!') {
                    // Redirect to admin panel
                    window.location.href = 'add-kurti.html';
                } else if (password !== null) { // Only show error if they didn't cancel
                    alert('❌ Invalid password');
                }
            }
        });
    </script>
</body>
</html>
